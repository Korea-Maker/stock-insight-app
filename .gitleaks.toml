# Gitleaks configuration for Stock Insight App
# https://github.com/gitleaks/gitleaks

title = "Stock Insight App Gitleaks Config"

[extend]
# Use the default gitleaks config as base
useDefault = true

# Custom rules for API keys used in this project
[[rules]]
id = "openai-api-key"
description = "OpenAI API Key"
regex = '''sk-proj-[a-zA-Z0-9_-]{20,}'''
tags = ["key", "openai"]

[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-[a-zA-Z0-9_-]{20,}'''
tags = ["key", "anthropic"]

[[rules]]
id = "finnhub-api-key"
description = "Finnhub API Key"
regex = '''[a-z]{2}[0-9a-z]{18}'''
tags = ["key", "finnhub"]
# This pattern is generic, so we add entropy check
entropy = 3.5

[[rules]]
id = "lemonsqueezy-api-key"
description = "Lemon Squeezy API Key"
regex = '''eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9\.[a-zA-Z0-9_-]+\.[a-zA-Z0-9_-]+'''
tags = ["key", "lemonsqueezy", "jwt"]

[[rules]]
id = "polar-api-key"
description = "Polar API Key (Legacy - for history scanning)"
regex = '''polar_oat_[a-zA-Z0-9_-]{20,}'''
tags = ["key", "polar", "legacy"]

# Allowlist for false positives
[allowlist]
description = "Global allowlist"

# Allow paths that commonly contain non-sensitive data
paths = [
    '''\.env\.example$''',
    '''\.env\.template$''',
    '''\.env\.sample$''',
    '''docs/.*''',
    '''\.md$''',
    '''tests/.*fixtures.*''',
    '''__pycache__/.*''',
    '''node_modules/.*''',
    '''\.next/.*''',
    '''\.git/.*''',
]

# Allow specific patterns that look like secrets but aren't
regexes = [
    # Example/placeholder keys
    '''sk-proj-your-api-key-here''',
    '''sk-ant-your-api-key-here''',
    '''your[-_]?api[-_]?key''',
    '''your[-_]?lemonsqueezy[-_]?api[-_]?key''',
    '''your[-_]?store[-_]?id''',
    '''your[-_]?variant[-_]?id''',
    '''your[-_]?webhook[-_]?secret''',
    '''polar_oat_your-polar-api-key''',
    '''your-polar-product-id''',
    '''<your[-_]?.*[-_]?key>''',
    '''REPLACE[-_]?ME''',
    '''xxx+''',
    # Common test values
    '''test[-_]?key''',
    '''fake[-_]?key''',
    '''dummy[-_]?key''',
    '''mock[-_]?key''',
]

# Allow specific commits (use sparingly)
# commits = []
